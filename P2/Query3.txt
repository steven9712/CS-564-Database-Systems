/* schoi243*/*/
SELECT OWN.N_NAME, ROUND(OWN.SIZE, 4), ROUND(DIFF.SIZE, 4)
FROM
(SELECT SUPPLY.N_NAME, SUM(L_QUANTITY * (L_EXTENDEDPRICE - L_DISCOUNT)) as "SIZE"
FROM Lineitem, Orders, Customer, Supplier, Nation as "SUPPLY", Nation as "CUST"
WHERE S_NATIONKEY = SUPPLY.N_NATIONKEY AND
C_NATIONKEY = CUST.N_NATIONKEY AND
SUPPLY.N_REGIONKEY = CUST.N_REGIONKEY AND
S_SUPPKEY = L_SUPPKEY AND
C_CUSTKEY = O_CUSTKEY AND
L_ORDERKEY = O_ORDERKEY
GROUP BY SUPPLY.N_NAME) AS "OWN",
(SELECT SUPPLY.N_NAME, SUM(L_QUANTITY * (L_EXTENDEDPRICE - L_DISCOUNT)) as "SIZE"
FROM Lineitem, Orders, Customer, Supplier, Nation as "SUPPLY", Nation as "CUST"
WHERE S_NATIONKEY = SUPPLY.N_NATIONKEY AND
C_NATIONKEY = CUST.N_NATIONKEY AND
SUPPLY.N_REGIONKEY != CUST.N_REGIONKEY AND
S_SUPPKEY = L_SUPPKEY AND
C_CUSTKEY = O_CUSTKEY AND
L_ORDERKEY = O_ORDERKEY
GROUP BY SUPPLY.N_NAME) AS "DIFF"
WHERE OWN.N_NAME = DIFF.N_NAME
ORDER BY OWN.SIZE DESC
;